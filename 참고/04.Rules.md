0) 읽기 순서 & 프로젝트 경로

항상 세션 시작 시 이 파일을 먼저 읽고 지시를 준수한다.

이후 아래 섹션을 순서대로 점검한다:

개요 → 2) 개발 방법(TDD) → 3) Stub 정책 → 4) 백엔드 협업(간단) → 5) 세션 필독 목록 → 6~15) 실무 가이드

프로젝트 루트: C:\Users\btsoft\Desktop\personal\vibe-cording\DearQ

참고 폴더: C:\Users\btsoft\Desktop\personal\vibe-cording\DearQ\참고 (이 안의 모든 파일을 먼저 분석하고 인사이트 반영)

1) 프로젝트 개요

제품명: 마음배달 (영문/프로젝트명: DearQ)

핵심 가치: “매일 하나의 질문으로 가족의 마음을 배달합니다.”

기본 스택: Next.js 15, React 19, Tailwind CSS v4, shadcn/ui

출력 언어: 모든 분석/문서/로그/커밋 메시지 한국어 (코드 식별자는 영어 허용)

디자인 규칙(요약)

배경 그라데이션 금지, 페이지 배경은 연한 톤(Primary-100/Surface)

터치 타겟 ≥ 44×44px, 대비 ≥ 4.5:1, 포커스 링 항상 표시

2) 개발 방법 – TDD

원칙: Red → Green → Refactor.

도구: Jest, React Testing Library, MSW(Stub), Playwright(E2E), Storybook(UI)

규율: 컴포넌트/훅/페이지 단위로 테스트를 먼저 작성하고 Stub로 통과시킨다.

3) Stub 정책(간단)

목적: 백엔드 미구현 단계에서 UI·플로우·예외처리를 검증.

규칙

Stub은 가정 API 스펙(이 파일의 8절 예시 활용)을 따른다.

모든 엔드포인트는 최소 4가지 시나리오를 지원:
success | failure | expired | empty (예: ?scenario=expired)

MSW 핸들러로 구현하고 Storybook/E2E에서도 동일 Stub 사용.

환경 스위치: 기본값 USE_REAL_API=false (실서버 전환은 후술).

보안 주의: 토큰·개인정보는 Stub에도 노출 금지(더미/마스킹).

4) 백엔드 협업(간단)

요청 타이밍(단순화): Stub 환경에서 Core Flow 데모가 자연스럽게 동작하면(로그인 → 질문 보기 → 전송 → 수신자 답변 → 대화 보기), 적정 시점에 백엔드 착수를 요청한다.

핸드오프 패키지:

OpenAPI 초안(8절, 필요 시 docs/api-spec.yaml로 분리)

DEMO 안내(15절)

에러·상태·분석 표준(6, 7, 8절)

5) 세션 필독 목록

CLAUDE.MD(본 문서) → 6~15절까지 훑고 수행

참고 폴더의 모든 파일 (PRD/템플릿/디자인 가이드 등)

존재 시: todo.md, docs/*(plan/ui_spec/routes/assumptions 등)

6) 에러/만료 마이크로카피 표준 (copy_errors_ko)
상황	사용자 메시지(제목/본문)	행동 버튼
만료(expired)	링크 유효시간이 지났어요. 새 링크를 요청해주세요.	[새 링크 요청] / [닫기]
중복(submitted)	이미 답변을 제출했어요. 대화 화면에서 확인해주세요.	[대화로 이동]
실패(failure)	문제가 발생했어요. 잠시 후 다시 시도해주세요.	[다시 시도]
오프라인(offline)	네트워크 연결이 불안정해요. 연결 후 다시 시도해주세요.	[다시 시도]
인증 만료(auth)	로그인이 필요해요. 로그인 후 진행됩니다.	[로그인]

톤: 친절·간결, 해결책 제시형. 재시도/새 링크/로그인 등 즉시 행동 제공.

7) 상태 화면 가이드 (states)

로딩(loading): 스켈레톤(문단 23줄 + 버튼 1개) 8001200ms

빈 상태(empty): “아직 대화가 없어요. 오늘의 질문으로 시작해보세요.” + CTA

에러(error): 6절의 표준 문구 + 복구 버튼

접근성: 로딩/에러/빈 상태는 스크린리더에 명확히 읽히도록 role/aria-live 사용

8) 분석(Analytics) 최소 세트 (analytics)

퍼널: auth_success → open_send → send_share_complete → receiver_answer_submit → conversation_complete

이벤트	필수 속성	설명
auth_success	user_id	로그인 성공
open_send	label_id	보내기 모달 오픈
send_share_complete	label_id, token_id	공유 트리거 완료
receiver_answer_submit	conversation_id	수신자 답변 제출
conversation_complete	conversation_id	양측 답변 완료
// 예시 페이로드
{
  "event": "receiver_answer_submit",
  "props": {
    "conversation_id": "conv_123",
    "label_id": "mom",
    "question_id": "q_20250825"
  }
}

9) 환경설정 & 셋업 (env + setup)
.env.example
# API
USE_REAL_API=false
API_BASE_URL=http://localhost:3000/api

# Kakao
KAKAO_REST_KEY=__your_key__
KAKAO_REDIRECT_URI=http://localhost:3000/login/callback

로컬 실행 3단계

패키지 설치: npm i

개발 서버: npm run dev

테스트/스토리북: npm run test, npm run storybook

실제 키는 .env.local에만. 절대 커밋하지 말 것.

10) 보안 & 입력제한 (security_input)

답변 길이: 2~800자 (프론트·서버 동일 검증)

XSS 방지: 입력은 HTML sanitize, 링크 자동 인식 시 새 창 + rel="noopener"

토큰: 1회용, 기본 만료 24h(환경변수로 조정), 제출 즉시 무효화

11) 접근성 체크리스트 (a11y)

대비 ≥ 4.5:1, 포커스 링 항상 표시

키보드 네비게이션 전 경로 지원(Tab/Shift+Tab)

스크린리더 레이블/역할 정확히 제공

모션 민감 사용자 옵션(애니메이션 감쇠)

12) 성능 기준 (perf)

TTI < 2.5s(3G Fast 가정), 코드 스플리팅, 이미지 최적화

라이트하우스 CI(점수 80 미만 경고)

중요 리소스 프리로드, 사용하지 않는 코드 제거

13) 반응형 규칙 (responsive)

브레이크포인트: 360 / 768 / 1024

모바일 퍼스트, 콘텐츠 최대폭 720~960 가이드

터치 타겟 ≥ 44×44px, 스크롤 영역 충분한 패딩

14) 로케일 & 시간 (locale_time)

TZ: Asia/Seoul

형식: 날짜 YYYY.MM.DD, 시간 24h(HH:mm)

상대시간(예: “3분 전”)은 접근성 대체 텍스트 제공

15) DEMO 스크립트 (핵심 흐름)

로그인(/login) → returnTo 유지 확인

홈(/home) “오늘의 질문” 노출 & 스테퍼 동작

보내기 모달: 최근 라벨 우선, 공유 트리거

수신자 링크(/r/:token) 접속 → 답변 제출(만료/중복도 확인)

대화 보기(/conversation/:id)에서 자기표현 게이트 해제 & 축하 모션

주간 하이라이트(/weekly) 카드 생성·공유 버튼 확인

16) 개발자용 시뮬레이터 토글(Dev only)

쿼리: ?scenario=success|failure|expired|empty

Dev 모드에서만 UI에 노출(빌드 시 자동 숨김)

MSW 핸들러가 시나리오별 응답을 반환하도록 연결

17) 실행 메모(권장)

문서 분리가 필요하면 6~15절을 각각 docs/*.md로 쪼개 저장하고, 이 파일의 “세션 필독 목록”에 해당 경로를 추가한다.

백엔드 요청은 과도하게 규칙화하지 말고, Core Flow 데모가 자연스러우면 바로 요청한다.

변경/결정은 간단히 Changelog 섹션에 적는다.

Changelog

2025-08-25: 초기 버전 작성. TDD·Stub·디자인/접근성/성능/분석 표준 간단 정리.